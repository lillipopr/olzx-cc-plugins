# 战术设计评分标准

> **满分**：100 分
> **及格分**：60 分
> **推荐分**：85 分以上
> **权重**：30%（最高权重）

---

## 评分维度

战术设计从 6 个维度评分，每个维度有具体的评分项。

| 维度 | 满分 | 说明 |
|------|------|------|
| 聚合设计 | 25 分 | 聚合识别、边界定义、聚合间引用 |
| 实体与值对象 | 20 分 | 实体识别、值对象设计、区分标准 |
| 领域事件 | 15 分 | 事件定义、携带数据、订阅方 |
| 领域服务 | 10 分 | 服务识别、职责定义 |
| 仓储接口 | 15 分 | 接口定义、查询方法 |
| 应用层接口 | 15 分 | 用户行为、系统行为 |

---

## 一、聚合设计（25 分）

### 1.1 聚合识别（10 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **聚合根正确** | 5 分 | 聚合根识别正确，是实体的收敛中心（5 分正确，3 分基本正确，0 分错误） |
| **边界合理** | 5 分 | 聚合边界由不变量决定，边界合理（5 分合理，3 分可接受，0 分不合理） |

**扣分项**：
- 聚合根错误：将值对象当作聚合根扣 5 分
- 边界过大：聚合包含过多实体扣 3 分
- 边界过小：本该聚合的实体被拆分扣 3 分

---

### 1.2 聚合图（8 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **结构清晰** | 4 分 | 聚合层级结构清晰（4 分清晰，2 分可读，0 分混乱） |
| **类型标注** | 2 分 | 实体/值类型类型正确标注（2 分正确，1 分部分正确，0 分错误） |
| **关系明确** | 2 分 | 聚合内关系明确（2 分明确，1 分可理解，0 分模糊） |

**扣分项**：
- 结构混乱：无法理解聚合结构扣 3 分
- 类型错误：实体和值对象混淆扣 2 分
- 关系不清：聚合内关系不明确扣 1 分/处

---

### 1.3 聚合间引用（7 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **引用方式正确** | 4 分 | 使用 ID 引用而非对象引用（4 分正确，2 分部分正确，0 分错误） |
| **引用类型合理** | 3 分 | 直接引用/事件驱动选择合理（3 分合理，2 分可接受，0 分不合理） |

**扣分项**：
- 对象引用：聚合间直接引用对象扣 3 分
- 类型错误：应使用事件驱动却用直接引用扣 2 分

---

## 二、实体与值对象（20 分）

### 2.1 聚合根列表（6 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **唯一标识** | 2 分 | 每个聚合根都有唯一标识（2 分完整，1 分部分完整，0 分缺失） |
| **生命周期** | 2 分 | 生命周期定义清晰（2 分清晰，1 分可理解，0 分模糊） |
| **不变量** | 2 分 | 承载的不变量已列出（2 分完整，1 分部分完整，0 分缺失） |

**扣分项**：
- 标识缺失：无唯一标识扣 2 分/个
- 生命周期模糊：生命周期不明确扣 1 分/个
- 不变量缺失：未列出不变量扣 1 分/个

---

### 2.2 实体列表（5 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **三条件筛选** | 3 分 | 每个实体满足三个条件（唯一ID、生命周期、状态转移）（3 分满足，0 分不满足） |
| **所属聚合** | 2 分 | 每个实体都有明确的所属聚合（2 分明确，1 分可确定，0 分不明确） |

**扣分项**：
- 三条件缺失：实体不满足三个条件扣 3 分/个
- 聚合归属不明：实体未标注所属聚合扣 1 分/个

---

### 2.3 值对象列表（5 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **不变性** | 3 分 | 值对象的不变性已说明（3 分明确，1 分可理解，0 分未说明） |
| **所属实体** | 2 分 | 每个值对象都有所属实体（2 分明确，1 分可确定，0 分不明确） |

**扣分项**：
- 不变性未说明：未说明值对象不可变扣 2 分/个
- 归属不明：值对象未标注所属实体扣 1 分/个

---

### 2.4 实体 vs 值对象判断依据（4 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **判断标准明确** | 2 分 | 三个判断条件已列出（2 分明确，0 分未列出） |
| **实际应用** | 2 分 | 所有实体都符合判断标准（2 分符合，0 分不符合） |

**扣分项**：
- 标准未列出：未列出判断条件扣 2 分
- 应用不一致：实体不符合标准扣 2 分/个

---

## 三、领域事件（15 分）

### 3.1 事件列表（8 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **事件完整性** | 3 分 | 重要状态变化都有对应事件（3 分完整，1 部分完整，0 分缺失） |
| **命名规范** | 2 分 | 事件名称使用过去式动词（2 分规范，1 分基本规范，0 分不规范） |
| **触发条件明确** | 3 分 | 每个事件触发条件明确（3 分明确，1 分可理解，0 分模糊） |

**扣分项**：
- 事件缺失：重要状态变化无事件扣 2 分/处
- 命名错误：未使用过去式扣 1 分/个
- 条件模糊：触发条件不明确扣 1 分/个

---

### 3.2 携带数据（4 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **数据完整** | 2 分 | 携带必要的数据字段（2 分完整，1 分基本完整，0 分缺失） |
| **不可变性** | 2 分 | 携带的数据不可变（2 分符合，0 分不符合） |

**扣分项**：
- 数据缺失：缺少必要字段扣 1 分/个
- 可变数据：数据可变扣 2 分

---

### 3.3 订阅方（3 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **订阅方明确** | 2 分 | 每个事件都有明确的订阅方（2 分明确，1 分部分明确，0 分不明确） |
| **处理逻辑** | 1 分 | 订阅方的处理逻辑已说明（1 分说明，0 分未说明） |

**扣分项**：
- 订阅方不明：事件没有订阅方扣 1 分/个
- 逻辑未说明：处理逻辑未说明扣 1 分/个

---

## 四、领域服务（10 分）

### 4.1 领域服务识别（4 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **识别正确** | 4 分 | 需要领域服务的地方都识别出来了（4 分正确，2 分部分正确，0 分错误） |

**判断标准**：
- 涉及多个聚合根的协作 → 需要领域服务
- 不属于任何特定实体的行为 → 需要领域服务
- 需要访问领域外服务 → 需要领域服务

**扣分项**：
- 识别缺失：需要领域服务但未设计扣 2 分/处
- 识别错误：不需要领域服务却设计了扣 1 分/处

---

### 4.2 领域服务列表（6 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **职责清晰** | 3 分 | 每个领域服务职责清晰（3 分清晰，1 分可理解，0 分模糊） |
| **涉及的聚合** | 2 分 | 涉及的聚合已列出（2 分完整，1 分部分完整，0 分缺失） |
| **依赖明确** | 1 分 | 外部依赖已明确（1 分明确，0 分不明确） |

**扣分项**：
- 职责模糊：职责不清晰扣 2 分/个
- 聚合缺失：未列出涉及的聚合扣 1 分/个
- 依赖不明：外部依赖不明确扣 1 分/个

---

## 五、仓储接口（15 分）

### 5.1 仓储定义（3 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **一一对应** | 3 分 | 每个聚合根对应一个仓储（3 分符合，0 分不符合） |

**扣分项**：
- 一对多：一个聚合根多个仓储扣 2 分
- 缺失：聚合根没有对应仓储扣 3 分

---

### 5.2 仓储接口列表（6 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **核心方法** | 3 分 | 包含 findById、save、delete（3 分完整，2 部分完整，0 分缺失） |
| **查询方法** | 3 分 | 包含必要的查询方法（3 分合理，1 分基本合理，0 分不合理） |

**扣分项**：
- 方法缺失：缺少核心方法扣 1 分/个
- 查询不合理：查询方法不合理扣 1 分/个

---

### 5.3 仓储接口定义模板（6 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **类型安全** | 2 分 | 接口定义类型安全（2 分安全，1 分基本安全，0 分不安全） |
| **返回值明确** | 2 分 | 返回值类型明确（2 分明确，1 分可理解，0 分模糊） |
| **异常处理** | 2 分 | 异常处理已考虑（2 分考虑，0 分未考虑） |

**扣分项**：
- 类型不安全：返回类型不明确扣 2 分
- 异常未处理：未说明异常处理扣 2 分

---

## 六、应用层接口（15 分）

### 6.1 用户行为（7 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **行为完整性** | 3 分 | 覆盖所有用户操作（3 分完整，1 分部分完整，0 分缺失） |
| **触发方明确** | 2 分 | 触发方明确（用户/外部系统）（2 分明确，1 分可确定，0 分不明确） |
| **应用服务对应** | 2 分 | 每个行为都有对应的应用服务（2 分对应，0 分不对应） |

**扣分项**：
- 行为缺失：用户操作未列出扣 1 分/个
- 触发方不明：触发方不明确扣 1 分/个
- 服务未对应：行为没有对应服务扣 1 分/个

---

### 6.2 系统行为（7 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **行为完整性** | 3 分 | 覆盖所有系统行为（定时任务、事件监听）（3 分完整，1 分部分完整，0 分缺失） |
| **触发方式** | 2 分 | 触发方式明确（定时任务/事件监听）（2 分明确，1 分可确定，0 分不明确） |
| **实现方式** | 2 分 | 实现方式已说明（2 分说明，1 分可理解，0 分未说明） |

**扣分项**：
- 行为缺失：系统行为未列出扣 1 分/个
- 触发不明：触发方式不明确扣 1 分/个
- 实现未说明：实现方式未说明扣 1 分/个

---

### 6.3 应用层接口定义模板（1 分）

| 评分项 | 满分 | 评分标准 |
|--------|------|----------|
| **接口定义** | 1 分 | 接口定义格式正确（1 分正确，0 分错误） |

**扣分项**：
- 格式错误：接口定义格式错误扣 1 分

---

## 评分示例

### 优秀示例（95 分）

```
聚合设计：
- 聚合根正确：5/5
- 边界合理：5/5
- 结构清晰：4/4
- 类型标注：2/2
- 关系明确：2/2
- 引用方式正确：4/4
- 引用类型合理：3/3
小计：25/25

实体与值对象：
- 唯一标识：2/2
- 生命周期：2/2
- 不变量：2/2
- 三条件筛选：3/3
- 所属聚合：2/2
- 不变性：3/3
- 所属实体：2/2
- 判断标准明确：2/2
- 实际应用：2/2
小计：20/20

领域事件：
- 事件完整性：3/3
- 命名规范：2/2
- 触发条件明确：3/3
- 数据完整：2/2
- 不可变性：2/2
- 订阅方明确：2/2
- 处理逻辑：1/1
小计：15/15

领域服务：
- 识别正确：4/4
- 职责清晰：3/3
- 涉及的聚合：2/2
- 依赖明确：1/1
小计：10/10

仓储接口：
- 一一对应：3/3
- 核心方法：3/3
- 查询方法：3/3
- 类型安全：2/2
- 返回值明确：2/2
- 异常处理：2/2
小计：15/15

应用层接口：
- 行为完整性：3/3
- 触发方明确：2/2
- 应用服务对应：2/2
- 行为完整性：3/3
- 触发方式：2/2
- 实现方式：2/2
- 接口定义：1/1
小计：15/15

总分：100/100
```

---

## 常见扣分项汇总

| 问题 | 扣分 |
|------|------|
| 聚合根识别错误 | -5 分 |
| 聚合边界不合理 | -3 分 |
| 聚合间对象引用 | -3 分 |
| 实体不满足三条件 | -3 分/个 |
| 值对象不变性未说明 | -2 分/个 |
| 领域事件缺失 | -2 分/处 |
| 领域服务识别错误 | -2 分/处 |
| 仓储接口缺失 | -3 分 |
| 用户行为缺失 | -1 分/个 |
| 系统行为缺失 | -1 分/个 |
