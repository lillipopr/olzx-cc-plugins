---
description: 首次功能建设完整工作流
---

# 首次功能建设（Full Feature）

## 适用场景

- 全新功能开发
- 从零开始的项目
- 需要完整走完 4 个 Stage

## 执行流程

```
Stage 1: PRD → Stage 2: DDD Design → Stage 3: Spec Modeling → Stage 4: Artifact Derivation
```

## 详细步骤

### Step 1: 启动

1. 确认需求来源（用户故事/业务需求）
2. 识别涉及的端（后端/iOS/Android/前端）
3. 告知用户将按 4 Stage 执行

### Step 2: Stage 1 - PRD

**执行者**：PM

**产出**：《产品需求文档》

**AI 辅助**：
- 帮助梳理用户故事
- 检查验收标准是否可测
- 提示遗漏的边界情况

**闸口**：
```
📋 Stage 1《产品需求文档》已完成
请 Review：
- 背景和目标是否清晰
- 用户故事是否完整
- 功能范围是否明确
- 验收标准是否可测

Review 通过后请回复"继续"
```

### Step 3: Stage 2 - DDD Design

**执行者**：架构师

**产出**：《DDD 设计文档》

**AI 辅助**：
- 识别聚合根和实体
- 建议限界上下文划分
- 检查上下文映射完整性

**闸口**：
```
📋 Stage 2《DDD 设计文档》已完成
请 Review：
- 限界上下文边界是否清晰
- 聚合设计是否合理
- 实体/值对象区分是否正确
- 领域事件是否完整

Review 通过后请回复"继续"
```

### Step 4: Stage 3 - Spec Modeling

**执行者**：AI + 人工审核

**产出**：《规格建模文档》

**AI 执行**：
1. 从 DDD 实体提取状态
2. 绘制状态转移图
3. 定义不变量（伪代码）
4. 生成用例（含 Bad Case）
5. 生成覆盖矩阵

**闸口**：
```
📋 Stage 3《规格建模文档》已完成
请 Review：
- 状态枚举是否完备且互斥
- 状态转移图是否正确
- 不变量是否完整
- Bad Case 是否覆盖所有禁止态
- 覆盖矩阵是否完备

Review 通过后请回复"继续"
```

### Step 5: Stage 4 - Artifact Derivation

**执行者**：AI + 人工审核

**产出**：《工件推导文档》

**AI 执行**：
1. 确定各端分层架构
2. 定义接口契约
3. 映射实现位置
4. 生成代码骨架

**闸口**：
```
📋 Stage 4《工件推导文档》已完成
请 Review：
- 分层架构是否清晰
- 接口契约是否完整
- 各端契约是否一致
- 实现位置是否明确

Review 通过后可开始编码
```

## 产出物清单

| Stage | 产出物 | 文件命名 |
|-------|--------|---------|
| 1 | 产品需求文档 | `{feature}-prd.md` |
| 2 | DDD 设计文档 | `{feature}-ddd-design.md` |
| 3 | 规格建模文档 | `{feature}-spec-modeling.md` |
| 4 | 工件推导文档 | `{feature}-artifact.md` |

## 注意事项

1. **不能跳过任何 Stage**
2. **每个 Stage 必须等待用户确认**
3. **修改后需重新 Review**
4. **下游变更需检查上游一致性**
