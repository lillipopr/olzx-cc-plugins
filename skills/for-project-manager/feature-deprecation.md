---
description: 功能下线工作流
---

# 功能下线（Feature Deprecation）

## 适用场景

- 功能废弃
- 业务调整导致功能移除
- 技术重构导致功能替换

## 执行流程

```
Stage 3: Spec Modeling（标记删除） → Stage 4: Artifact Derivation（逆向清理）
```

## 核心理念

**熵控原则**：功能下线必须彻底清理，不允许遗留死代码。

## 详细步骤

### Step 1: 影响分析

1. 确认要下线的功能范围
2. 分析依赖关系
3. 评估影响面

**分析模板**：
```markdown
## 下线影响分析

### 下线功能
[功能名称和描述]

### 涉及实体
- [实体 1]
- [实体 2]

### 涉及用例
- [TC-XX]
- [TC-YY]

### 依赖方
- [上游依赖]
- [下游依赖]
```

### Step 2: Stage 3 - 标记删除

**执行**：
1. 标记要删除的状态
2. 标记要删除的不变量
3. 标记要删除的用例

**闸口**：
```
📋 下线范围已标记

删除内容：
- 状态：[列表]
- 不变量：[列表]
- 用例：[列表]

请 Review 删除范围是否正确，Review 通过后请回复"继续"
```

### Step 3: Stage 4 - 逆向清理

**执行**：
1. 列出要删除的接口
2. 列出要删除的代码文件/方法
3. 列出要删除的配置

**清理清单**：
```markdown
## 清理清单

### 接口删除
| 接口 | 文件位置 |
|------|---------|
| POST /api/xxx | Controller.java |

### 代码删除
| 类型 | 文件 | 内容 |
|------|------|------|
| 类 | XxxService.java | 整个文件 |
| 方法 | YyyService.java | methodName() |

### 配置删除
| 配置项 | 文件 |
|--------|------|
| xxx.enabled | application.yml |
```

**闸口**：
```
📋 清理清单已生成

请 Review 清理范围是否完整，Review 通过后可开始清理
```

## 注意事项

1. **彻底删除** - 不要注释，直接删除
2. **Git 追溯** - 通过 Git 历史可找回
3. **同步文档** - 更新 PRD、DDD 设计等文档
4. **通知依赖方** - 提前通知上下游
