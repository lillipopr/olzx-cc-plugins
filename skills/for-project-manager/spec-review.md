---
description: 规格文档审查工作流
---

# 规格文档审查（Spec Review）

## 适用场景

- 审查已有的规格文档是否完整
- 检查文档间的一致性
- 发现潜在的遗漏和问题

## 审查维度

### 1. PRD 审查

| 检查项 | 检查内容 | 严重级别 |
|--------|---------|---------|
| 需求清晰度 | 背景、目标是否明确 | HIGH |
| 用户故事 | 角色、功能、价值是否完整 | HIGH |
| 功能范围 | In/Out Scope 是否明确 | MEDIUM |
| 验收标准 | Given-When-Then 是否可测 | HIGH |

### 2. DDD 设计审查

| 检查项 | 检查内容 | 严重级别 |
|--------|---------|---------|
| 限界上下文 | 边界是否清晰、职责是否单一 | HIGH |
| 聚合设计 | 聚合根是否正确、大小是否合理 | HIGH |
| 实体/值对象 | 区分是否正确 | MEDIUM |
| 领域事件 | 触发时机、携带数据是否完整 | MEDIUM |

### 3. 规格建模审查

| 检查项 | 检查内容 | 严重级别 |
|--------|---------|---------|
| 状态完备性 | 状态是否覆盖所有情况 | CRITICAL |
| 状态互斥性 | 是否存在状态重叠 | CRITICAL |
| 不变量完整性 | 业务规则是否都有不变量 | HIGH |
| 不变量可验证性 | 是否能写成断言 | HIGH |
| 用例覆盖度 | 是否覆盖所有状态转移 | HIGH |
| Bad Case 存在性 | 是否有禁止态用例 | CRITICAL |
| 覆盖矩阵 | 每个不变量是否都被覆盖 | HIGH |

### 4. 工件推导审查

| 检查项 | 检查内容 | 严重级别 |
|--------|---------|---------|
| 分层清晰度 | 各层职责是否明确 | HIGH |
| 接口完整性 | 入参/返回/错误码是否完整 | HIGH |
| 契约一致性 | 各端接口是否一致 | CRITICAL |
| 位置明确性 | 实现位置是否明确到类/方法 | MEDIUM |
| 用例关联 | 每个接口是否关联用例 | HIGH |

### 5. 跨文档一致性审查

| 检查项 | 检查内容 | 严重级别 |
|--------|---------|---------|
| PRD → DDD | 需求是否都有领域模型支撑 | HIGH |
| DDD → 规格 | 实体是否都有状态定义 | HIGH |
| 规格 → 工件 | 不变量是否都有实现位置 | HIGH |
| 用例追溯 | 用例是否能追溯到验收标准 | MEDIUM |

## 执行流程

```
1. 收集文档
   ├─ 识别文档类型（PRD/DDD/规格/工件）
   └─ 加载文档内容

2. 单文档审查
   ├─ 按维度逐项检查
   └─ 记录问题和严重级别

3. 跨文档一致性审查
   ├─ 检查追溯链
   └─ 检查概念一致性

4. 输出审查报告
   ├─ 按严重级别排序
   └─ 给出修复建议
```

## 审查报告格式

```markdown
# 规格文档审查报告

## 审查范围
- PRD: {文件路径}
- DDD: {文件路径}
- 规格建模: {文件路径}
- 工件推导: {文件路径}

## 问题汇总

| 级别 | 数量 |
|------|------|
| CRITICAL | X |
| HIGH | X |
| MEDIUM | X |

## 详细问题

### CRITICAL

#### [C1] {问题标题}
- **位置**: {文档:章节}
- **问题**: {问题描述}
- **建议**: {修复建议}

### HIGH

#### [H1] {问题标题}
- **位置**: {文档:章节}
- **问题**: {问题描述}
- **建议**: {修复建议}

## 结论

- [ ] 通过审查，可进入下一阶段
- [ ] 需修复 CRITICAL 问题后重新审查
- [ ] 需修复 HIGH 问题后重新审查
```

## 闸口

- **CRITICAL 问题**：必须修复，否则不能进入下一阶段
- **HIGH 问题**：建议修复，可酌情放行
- **MEDIUM 问题**：建议修复，不阻塞流程
